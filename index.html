<!DOCTYPE html>
<html>
<body>
    <script>
        const TEST_SHEET_ID = "1Hd-aSvnKrXWk3QYEzxY1DjgxHk8fA49t2QmNoIhCMq4";
        const TEST_API_KEY = "AIzaSyBIAZIlEL2OqSP4SGvUjcjZwL9p7aPVWuA";

        async function testSheetAccess() {
            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${TEST_SHEET_ID}?key=${TEST_API_KEY}`
                );

                if (!response.ok) {
                    if (response.status === 404) {
                        console.error('المشكلة في الشيت:', response.statusText);
                        alert('❌ الشيت غير موجود أو غير مشترك بشكل public');
                    } else if (response.status === 403) {
                        console.error('المشكلة في الـ API:', response.statusText);
                        alert('❌ مشكلة في الـ API Key (ممنوع الوصول)');
                    } else {
                        console.error('خطأ غير متوقع:', response.status);
                        alert('⚠️ خطأ غير مت预期的: ' + response.status);
                    }
                    return;
                }

                const data = await response.json();
                const sheetNames = data.sheets.map(sheet => sheet.properties.title);
                
                console.log('أسماء الأوراق الموجودة:', sheetNames);
                alert(`✅ تم جلب ${sheetNames.length} ورقة بنجاح\nالأوراق: ${sheetNames.join(', ')}`);
                
            } catch (error) {
                console.error('خطأ في الشبكة:', error);
                alert('🚨 فشل الاتصال بالخادم - تأكد من اتصال الإنترنت');
            }
        }

        // تشغيل الاختبار تلقائيًا عند فتح الصفحة
        testSheetAccess();
    </script>
</body>
</html>
