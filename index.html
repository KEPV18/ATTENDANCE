<!DOCTYPE html>
<html>
<body>
    <script>
        const TEST_SHEET_ID = "1Hd-aSvnKrXWk3QYEzxY1DjgxHk8fA49t2QmNoIhCMq4";
        const TEST_API_KEY = "AIzaSyBIAZIlEL2OqSP4SGvUjcjZwL9p7aPVWuA";

        async function testSheetAccess() {
            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${TEST_SHEET_ID}?key=${TEST_API_KEY}`
                );

                if (!response.ok) {
                    if (response.status === 404) {
                        console.error('ุงููุดููุฉ ูู ุงูุดูุช:', response.statusText);
                        alert('โ ุงูุดูุช ุบูุฑ ููุฌูุฏ ุฃู ุบูุฑ ูุดุชุฑู ุจุดูู public');
                    } else if (response.status === 403) {
                        console.error('ุงููุดููุฉ ูู ุงูู API:', response.statusText);
                        alert('โ ูุดููุฉ ูู ุงูู API Key (ููููุน ุงููุตูู)');
                    } else {
                        console.error('ุฎุทุฃ ุบูุฑ ูุชููุน:', response.status);
                        alert('โ๏ธ ุฎุทุฃ ุบูุฑ ูุช้ขๆ็: ' + response.status);
                    }
                    return;
                }

                const data = await response.json();
                const sheetNames = data.sheets.map(sheet => sheet.properties.title);
                
                console.log('ุฃุณูุงุก ุงูุฃูุฑุงู ุงูููุฌูุฏุฉ:', sheetNames);
                alert(`โ ุชู ุฌูุจ ${sheetNames.length} ูุฑูุฉ ุจูุฌุงุญ\nุงูุฃูุฑุงู: ${sheetNames.join(', ')}`);
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุงูุดุจูุฉ:', error);
                alert('๐จ ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู - ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช');
            }
        }

        // ุชุดุบูู ุงูุงุฎุชุจุงุฑ ุชููุงุฆููุง ุนูุฏ ูุชุญ ุงูุตูุญุฉ
        testSheetAccess();
    </script>
</body>
</html>
